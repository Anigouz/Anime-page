
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AniGouz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    body { margin: 0; font-family: 'Poppins', sans-serif; background: #000; color: #fff; }
    header { text-align: center; padding: 1rem; font-size: 2rem; font-weight: bold; background-color: rgba(0,0,0,0.7); position: fixed; top: 0; width: 100%; z-index: 2; }
    .bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: -1; }
    .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 0; }
    #nav { position: fixed; bottom: 0; width: 100%; background: rgba(0,0,0,0.8); display: flex; justify-content: space-around; padding: 0.5rem 0; z-index: 2; }
    #nav button { background: none; border: none; color: white; font-size: 1.2rem; }
    #home, #news { padding-top: 4rem; display: none; }
    #home.active, #news.active { display: block; }
    .anime { margin: 1rem; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 10px; }
    .anime h3 { margin: 0 0 0.5rem; }
    .trailer { color: #00f0ff; cursor: pointer; text-decoration: underline; }
    iframe { width: 100%; height: 300px; border: none; margin-top: 1rem; }
  </style>
</head>
<body>
  <video class="bg" autoplay muted loop>
    <source src="https://firebasestorage.googleapis.com/v0/b/oilaviy-post.appspot.com/o/VID_20250615_221525_488.mp4?alt=media&token=f30320bc-361f-48f1-ac40-c9d1adc13d32" type="video/mp4">
  </video>
  <div class="overlay"></div>
  <header>AniGouz</header>

  <div id="home" class="active">
    <div id="animeList">Yuklanmoqda...</div>
  </div>
  <div id="news">
    <div style="padding: 1rem;">Yangiliklar hali mavjud emas.</div>
  </div>

  <div id="nav">
    <button onclick="toggleSection('home')">Home</button>
    <button onclick="toggleSection('news')">News</button>
  </div>

  <script>
    function toggleSection(id) {
      document.querySelectorAll('#home, #news').forEach(el => el.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    async function loadAnime() {
      const res = await fetch('https://api.jikan.moe/v4/top/anime');
      const data = await res.json();
      const list = document.getElementById('animeList');
      list.innerHTML = '';

      data.data.slice(0, 5).forEach(anime => {
        const div = document.createElement('div');
        div.className = 'anime';
        div.innerHTML = `
          <h3>${anime.title}</h3>
          <p>Score: ${anime.score}</p>
          <span class="trailer" onclick="showTrailer('${anime.title}')">Watch Trailer</span>
          <div class="viewCount" data-id="${anime.mal_id}">Ko‘rishlar: Yuklanmoqda...</div>
          <iframe id="yt-${anime.mal_id}" style="display:none;"></iframe>
        `;
        list.appendChild(div);
        loadViews(anime.mal_id);
      });
    }

    function showTrailer(query) {
      const ytQuery = encodeURIComponent(query + ' trailer');
      const url = `https://www.youtube.com/embed?listType=search&list=${ytQuery}`;
      const iframes = document.querySelectorAll('iframe');
      iframes.forEach(iframe => iframe.style.display = 'none');
      const iframe = [...iframes].find(el => el.id.includes('yt-'));
      if (iframe) {
        iframe.src = url;
        iframe.style.display = 'block';
      }
    }

    async function loadViews(id) {
      const res = await fetch(`https://api.countapi.xyz/hit/anigouz.com/${id}`);
      const data = await res.json();
      document.querySelector(`[data-id="${id}"]`).innerText = `Ko‘rishlar: ${data.value}`;
    }

    loadAnime();
  </script>
</body>
</html>
