<!DOCTYPE html><html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AniGouz</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #111;
      color: white;
    }
    #splash {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: black;
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    #splash video {
      position: absolute;
      width: 100%; height: 100%;
      object-fit: cover;
      z-index: -1;
    }
    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px 20px;
    }
    .toolbar h1 { color: #00d1ff; margin: 0; font-size: 22px; }
    .toolbar button {
      background: none; border: none; color: white;
      font-size: 20px; cursor: pointer;
    }
    .search-bar {
      display: none;
      padding: 10px 20px;
      background: rgba(0,0,0,0.5);
    }
    .search-bar input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      background: #222;
      color: white;
      border: none;
    }
    .container {
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }
    .anime {
      background: rgba(255,255,255,0.05);
      padding: 10px;
      margin-bottom: 16px;
      border-radius: 10px;
    }
    .anime img {
      width: 100%; border-radius: 8px;
    }
    .anime h3 { margin: 10px 0 4px; color: #00d1ff; }
    .anime p { color: #ccc; margin-bottom: 10px; }
    .anime button, .episode button {
      padding: 10px;
      border: none;
      background: #00ffc3;
      color: black;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
    }
    .episode {
      background: #222;
      padding: 10px;
      margin-top: 10px;
      border-radius: 10px;
    }
    #player iframe {
      width: 100%;
      height: 420px;
      border-radius: 10px;
      margin-top: 20px;
      border: none;
      box-shadow: 0 0 20px cyan;
    }
    #authModal, #profileSection {
      display: none;
      background: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 10px;
      margin: 20px auto;
      text-align: center;
    }
    #authModal input {
      width: 100%; padding: 10px; border-radius: 6px;
      background: #222; color: white; border: none; margin-bottom: 10px;
    }
    #authModal button, #profileSection button {
      padding: 10px;
      margin: 5px;
      background: #00d1ff;
      color: black;
      border: none;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
    }
    #backButton {
      display: none;
      margin: 15px 0;
      padding: 10px;
      background: #444;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<div id="splash">
  <video autoplay muted loop>
    <source src="https://firebasestorage.googleapis.com/v0/b/oilaviy-post.appspot.com/o/VID_20250615_221525_488.mp4?alt=media" type="video/mp4">
  </video>
  <h1>AniGouz</h1>
  <p>Bizda hammasi bepul!</p>
</div>
<div class="toolbar">
  <h1>AniGouz</h1>
  <div>
    <button onclick="toggleSearch()">üîç</button>
    <button onclick="showProfile()">üë§</button>
  </div>
</div>
<div class="search-bar" id="searchBox">
  <input type="text" id="search" placeholder="Anime qidiring..." onkeydown="checkSearchKey(event)">
</div>
<div class="container">
  <div id="authModal">
    <h2>Kirish</h2>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Parol">
    <button onclick="login()">Kirish</button>
    <button onclick="register()">Ro‚Äòyxatdan o‚Äòtish</button>
  </div>
  <button id="backButton" onclick="goBack()">‚Üê Orqaga</button>
  <div id="animeList"></div>
  <div id="episodeList" style="display:none;"></div>
  <div id="player" style="display:none;">
    <iframe id="archivePlayer" allowfullscreen></iframe>
  </div>
  <div id="profileSection">
    <h2>Profil</h2>
    <button onclick="logout()">Akkauntdan chiqish</button>
  </div>
</div>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyBgDwfB9F4mHVAGN_9F-5ZJI56RikyDaeU",
  authDomain: "tv-app-e4ef4.firebaseapp.com",
  databaseURL: "https://tv-app-e4ef4-default-rtdb.firebaseio.com",
  projectId: "tv-app-e4ef4",
  storageBucket: "tv-app-e4ef4.appspot.com",
  messagingSenderId: "224075442016",
  appId: "1:224075442016:web:718aafce5aa16163e06005"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();let allAnime = [];

setTimeout(() => { document.getElementById("splash").style.display = "none"; if (!auth.currentUser) { document.getElementById('authModal').style.display = 'block'; } }, 5000);

auth.onAuthStateChanged(user => { document.getElementById('splash').style.display = 'none'; if (user) { document.getElementById('authModal').style.display = 'none'; loadAnime(); } else { document.getElementById('authModal').style.display = 'block'; } });

function login() { auth.signInWithEmailAndPassword(email.value, password.value).catch(err => alert(err.message)); } function register() { auth.createUserWithEmailAndPassword(email.value, password.value).catch(err => alert(err.message)); } function logout() { auth.signOut().then(() => location.reload()); } function toggleSearch() { const box = document.getElementById('searchBox'); box.style.display = box.style.display === 'block' ? 'none' : 'block'; document.getElementById('search').value = ''; renderAnime(allAnime); } function checkSearchKey(e) { if (e.key === 'Enter') { filterAnime(); document.getElementById('searchBox').style.display = 'none'; } } function filterAnime() { const q = document.getElementById('search').value.toLowerCase(); renderAnime(allAnime.filter(a => a.title.toLowerCase().includes(q))); } function loadAnime() { db.ref('animeList').once('value', snap => { allAnime = []; snap.forEach(child => allAnime.push(child.val())); renderAnime(allAnime); }); } function renderAnime(list) { const box = document.getElementById('animeList'); box.innerHTML = ''; list.forEach(anime => { const el = document.createElement('div'); el.className = 'anime'; el.innerHTML = <img src="${anime.image}" /> <h3>${anime.title}</h3> <p>${anime.desc}</p> <button onclick="checkAuth('${anime.id}')">Qismlar</button>; box.appendChild(el); }); setView('home'); } function checkAuth(id) { if (!auth.currentUser) return document.getElementById('authModal').style.display = 'block'; loadEpisodes(id); } function loadEpisodes(id) { history.pushState({ view: 'episodes', animeId: id }, '', '#episodes'); setView('episodes'); db.ref('episodes/' + id).once('value', snap => { const container = document.getElementById('episodeList'); container.innerHTML = ''; snap.forEach(child => { const ep = child.val(); const el = document.createElement('div'); el.className = 'episode'; el.innerHTML = <h4>${ep.title}</h4><button onclick=\"playVideo('${ep.stream}')\">Tomosha qilish</button>; container.appendChild(el); }); }); } function playVideo(stream) { history.pushState({ view: 'player' }, '', '#player'); setView('player'); document.getElementById('archivePlayer').src = https://archive.org/embed/${stream}; } function showProfile() { history.pushState({ view: 'profile' }, '', '#profile'); setView('profile'); } function setView(v) { document.getElementById('animeList').style.display = 'none'; document.getElementById('episodeList').style.display = 'none'; document.getElementById('player').style.display = 'none'; document.getElementById('profileSection').style.display = 'none'; document.getElementById('authModal').style.display = 'none'; document.getElementById('backButton').style.display = v !== 'home' ? 'block' : 'none'; if (v === 'home') document.getElementById('animeList').style.display = 'block'; if (v === 'episodes') document.getElementById('episodeList').style.display = 'block'; if (v === 'player') document.getElementById('player').style.display = 'block'; if (v === 'profile') document.getElementById('profileSection').style.display = 'block'; } function goBack() { history.back(); } window.onpopstate = e => { if (!e.state || e.state.view === 'home') setView('home'); else if (e.state.view === 'episodes') loadEpisodes(e.state.animeId); else if (e.state.view === 'player') setView('player'); else if (e.state.view === 'profile') setView('profile'); }; </script>

</body>
                                                </html>
