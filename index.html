<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>AniGouz</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Poppins',sans-serif;color:#fff;background:#000;overflow-x:hidden;}
    video.bg{position:fixed;top:0;left:0;width:100%;height:100%;object-fit:cover;filter:brightness(0.5);z-index:-1;}
    header,nav.bottom{position:fixed;width:100%;background:rgba(0,0,0,0.7);z-index:2;}
    header{top:0;padding:10px;text-align:center;font-size:1.8rem;font-weight:600;}
    nav.bottom{bottom:0;display:flex;justify-content:space-around;padding:8px 0;}
    nav.bottom button, header button{background:none;border:none;color:#fff;font-size:1rem;cursor:pointer;}
    .section{display:none;padding:80px 20px 60px;}
    .active{display:block;}
    .anime-card{background:rgba(255,255,255,0.1);margin:10px 0;padding:15px;border-radius:8px;}
    .anime-card h3{margin-bottom:8px;}
    .anime-card img{width:100%;border-radius:6px;}
    .trailer-btn{display:inline-block;margin:10px 0;padding:6px 12px;background:#ff6b6b;color:#fff;border:none;border-radius:6px;cursor:pointer;}
    #trailerModal{position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.9);display:none;justify-content:center;align-items:center;z-index:3;}
    #trailerModal iframe{width:90%;max-width:720px;height:56vw;max-height:405px;border:none;border-radius:8px;}
    #trailerModal .close{position:absolute;top:20px;right:20px;font-size:2rem;color:#fff;cursor:pointer;}
    .sponsor{margin:20px auto;padding:10px;background:#222;border:2px dashed #888;text-align:center;border-radius:8px;}
    .news-item{background:rgba(255,255,255,0.1);padding:12px;margin:10px 0;border-radius:6px;}
    .view-count{font-size:0.9rem;color:#ccc;margin-top:6px;}
    @media (min-width:600px){.anime-card{display:flex;gap:10px;} .anime-card img{width:120px;height:180px;object-fit:cover;}}
  </style>
</head>
<body>

<video class="bg" autoplay muted loop src="https://firebasestorage.googleapis.com/v0/b/oilaviy-post.appspot.com/o/VID_20250615_221525_488.mp4?alt=media"/>
<header>
  AniGouz
  <button style="position:absolute;right:20px;top:12px;" onclick="toggleSection('news')">News</button>
</header>

<main>
  <section id="home" class="section active">
    <div class="sponsor">üëë Bu yerda homiy uchun banner bo‚Äòladi</div>
    <div id="animeList">Yuklanmoqda...</div>
  </section>

  <section id="news" class="section">
    <h2>Yangiliklar</h2>
    <div id="newsList">
      <div class="news-item">Yangiliklar hali mavjud emas.</div>
    </div>
  </section>
</main>

<nav class="bottom">
  <button onclick="toggleSection('home')">üè† Home</button>
  <button onclick="toggleSection('news')">üì∞ News</button>
</nav>

<div id="trailerModal">
  <span class="close" onclick="closeTrailer()">√ó</span>
  <iframe src="" allowfullscreen></iframe>
</div>

<script>
  function toggleSection(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  async function loadAnime(){
    const res = await fetch('https://api.jikan.moe/v4/seasons/upcoming');
    const json = await res.json();
    const list = document.getElementById('animeList');
    list.innerHTML = '';
    json.data.slice(0,6).forEach(a=>{
      const vid = a.trailer?.youtube_id;
      const div = document.createElement('div');
      div.className = 'anime-card';
      div.innerHTML = `
        <img src="${a.images.jpg.image_url}" alt="${a.titles[0].title}" />
        <div>
          <h3>${a.titles[0].title}</h3>
          <button class="trailer-btn" onclick="openTrailer('${vid}')">‚ñ∂ Treyler</button>
          <div class="view-count" id="vc-${a.mal_id}">Ko‚Äòrishlar: ...</div>
        </div>`;
      list.appendChild(div);
      fetch(`https://api.countapi.xyz/hit/anigouz/${a.mal_id}`)
        .then(r=>r.json())
        .then(c=>document.getElementById(`vc-${a.mal_id}`).innerText = 'Ko‚Äòrishlar: '+c.value);
    });
  }

  function openTrailer(id){
    if(!id) return alert('Treyler topilmadi');
    document.querySelector('#trailerModal iframe').src = 'https://www.youtube.com/embed/'+id+'?autoplay=1';
    document.getElementById('trailerModal').style.display = 'flex';
  }
  function closeTrailer(){
    document.getElementById('trailerModal').style.display = 'none';
    document.querySelector('#trailerModal iframe').src = '';
  }

  document.addEventListener('DOMContentLoaded',loadAnime);
</script>

</body>
</html>
